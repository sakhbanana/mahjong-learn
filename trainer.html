<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ğ¢Ñ€ĞµĞ½Ğ°Ğ¶Ñ‘Ñ€ â€” Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .level-indicator {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 16px;
      color: #8b0000;
      font-weight: bold;
    }
    .goal {
      background: #f0e6d2;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Ğ¢Ñ€ĞµĞ½Ğ°Ğ¶Ñ‘Ñ€ Ğ¼Ğ°Ğ´Ğ¶Ğ¾Ğ½Ğ³Ğ° ğŸ€„</h1>
    <nav>
      <a href="index.html">Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ</a>
      <a href="lessons.html">Ğ£Ñ€Ğ¾ĞºĞ¸</a>
      <a href="trainer.html">Ğ¢Ñ€ĞµĞ½Ğ°Ğ¶Ñ‘Ñ€</a>
    </nav>
  </header>

  <main class="section">
    <div class="level-indicator">Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ <span id="level">1</span> Ğ¸Ğ· 3</div>
    <div class="goal" id="goal-text">Ğ¦ĞµĞ»ÑŒ: ÑĞ¾Ğ±ĞµÑ€Ğ¸ <strong>Ğ¿Ğ°Ñ€Ñƒ</strong> (2 Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ñ… Ñ‚Ğ°Ğ¹Ğ»Ğ°)</div>

    <div class="hand" id="player-hand">
      <div class="instructions">ĞŸĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸ ÑÑĞ´Ğ° Ñ‚Ğ°Ğ¹Ğ»Ñ‹</div>
    </div>

    <div id="result"></div>

    <h3>ĞšĞ¾Ğ»Ğ¾Ğ´Ñ‹ Ñ‚Ğ°Ğ¹Ğ»Ğ¾Ğ²</h3>
    <div id="tiles-bank"></div>

    <button id="check-btn" style="margin-top: 16px; padding: 10px 20px; font-size: 16px;">ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ</button>
    <button id="next-btn" style="display:none; margin-left: 10px; padding: 10px 20px; background:#2e8b57; color:white;">Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ â†’</button>
  </main>

  <script src="main.js"></script>
  <script>
    const allTiles = [
      'ğŸ€','ğŸ€‘','ğŸ€’','ğŸ€“','ğŸ€”','ğŸ€•','ğŸ€–','ğŸ€—','ğŸ€˜',
      'ğŸ€‡','ğŸ€ˆ','ğŸ€‰','ğŸ€Š','ğŸ€‹','ğŸ€Œ','ğŸ€','ğŸ€','ğŸ€',
      'ğŸ€™','ğŸ€š','ğŸ€›','ğŸ€œ','ğŸ€','ğŸ€','ğŸ€Ÿ','ğŸ€ ','ğŸ€¡',
      'ğŸ€€','ğŸ€','ğŸ€‚','ğŸ€ƒ','ğŸ€…','ğŸ€†','ğŸ€„'
    ];

    let currentLevel = 1;
    const levelGoals = {
      1: 'Ğ¿Ğ°Ñ€Ñƒ',
      2: 'ÑĞµÑ‚ (3 Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ñ…)',
      3: 'Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑƒÑ Ñ€ÑƒĞºÑƒ (4 ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ + Ğ¿Ğ°Ñ€Ğ°)'
    };

    const tilesBank = document.getElementById('tiles-bank');
    const playerHand = document.getElementById('player-hand');
    const resultDiv = document.getElementById('result');
    const checkBtn = document.getElementById('check-btn');
    const nextBtn = document.getElementById('next-btn');
    const levelSpan = document.getElementById('level');
    const goalText = document.getElementById('goal-text');

    function updateLevel() {
      levelSpan.textContent = currentLevel;
      goalText.innerHTML = `Ğ¦ĞµĞ»ÑŒ: ÑĞ¾Ğ±ĞµÑ€Ğ¸ <strong>${levelGoals[currentLevel]}</strong>`;
      playerHand.innerHTML = '<div class="instructions">ĞŸĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸ ÑÑĞ´Ğ° Ñ‚Ğ°Ğ¹Ğ»Ñ‹</div>';
      resultDiv.innerHTML = '';
      nextBtn.style.display = 'none';
      generateTiles();
    }

    function generateTiles() {
      tilesBank.innerHTML = '';
      // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ 25 ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ñ… Ñ‚Ğ°Ğ¹Ğ»Ğ¾Ğ²
      for (let i = 0; i < 25; i++) {
        const char = allTiles[Math.floor(Math.random() * allTiles.length)];
        const tile = document.createElement('div');
        tile.className = 'tile';
        tile.innerHTML = createTileSVG(char);
        tile.draggable = true;
        tile.dataset.char = char;

        tile.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', char);
          tile.classList.add('dragging');
        });
        tile.addEventListener('dragend', () => tile.classList.remove('dragging'));
        tilesBank.appendChild(tile);
      }
    }

    playerHand.addEventListener('dragover', e => e.preventDefault());
    playerHand.addEventListener('drop', e => {
      e.preventDefault();
      const char = e.dataTransfer.getData('text/plain');
      const newTile = document.createElement('div');
      newTile.className = 'tile';
      newTile.innerHTML = createTileSVG(char);
      newTile.dataset.char = char;
      newTile.draggable = true;
      newTile.addEventListener('click', () => newTile.remove());
      if (playerHand.querySelector('.instructions')) playerHand.innerHTML = '';
      playerHand.appendChild(newTile);
    });

    function checkLevel1(tiles) {
      const counts = {};
      tiles.forEach(t => counts[t] = (counts[t] || 0) + 1);
      return Object.values(counts).some(count => count >= 2);
    }

    function checkLevel2(tiles) {
      const counts = {};
      tiles.forEach(t => counts[t] = (counts[t] || 0) + 1);
      return Object.values(counts).some(count => count >= 3);
    }

    checkBtn.addEventListener('click', () => {
      const handTiles = Array.from(playerHand.querySelectorAll('.tile')).map(t => t.dataset.char);
      let success = false;

      if (currentLevel === 1) {
        success = checkLevel1(handTiles);
      } else if (currentLevel === 2) {
        success = checkLevel2(handTiles);
      } else if (currentLevel === 3) {
        if (handTiles.length !== 14) {
          resultDiv.innerHTML = '<p style="color:#c00;">ĞÑƒĞ¶Ğ½Ğ¾ 14 Ñ‚Ğ°Ğ¹Ğ»Ğ¾Ğ²!</p>';
          return;
        }
        const result = checkHand(handTiles);
        success = result.isComplete;
      }

      if (success) {
        resultDiv.innerHTML = '<p class="success">âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ¦ĞµĞ»ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ°!</p>';
        playSound('success');
        nextBtn.style.display = 'inline-block';
      } else {
        resultDiv.innerHTML = `<p style="color:#c00;">âŒ ĞŸĞ¾ĞºĞ° Ğ½Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»Ğ¾ÑÑŒ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ ĞµÑ‰Ñ‘!</p>`;
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentLevel < 3) {
        currentLevel++;
        updateLevel();
      } else {
        resultDiv.innerHTML = '<p class="success">ğŸ† ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼! Ğ¢Ñ‹ Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ» Ğ²ÑĞµ ÑƒÑ€Ğ¾Ğ²Ğ½Ğ¸!</p>';
        nextBtn.style.display = 'none';
      }
    });

    // Ğ¡Ñ‚Ğ°Ñ€Ñ‚
    updateLevel();
  </script>
</body>
</html>
